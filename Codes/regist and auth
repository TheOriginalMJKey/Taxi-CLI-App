def regist_and_auth(message):
    try:
        # номер телефона пользователя
        input_phone = message.contact.phone_number    
        mydb = sqlite3.connect('database.db')
        mycursor = mydb.cursor()
        mycursor.execute('SELECT * FROM passengers')   # поиск номера телефона в таблице пассажиров      
        passengers = mycursor.fetchall()
    
        for user in passengers:
            table_phone = user[1]
            if table_phone == input_phone: 
                buttons_actions = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
                button_history_ways = types.KeyboardButton(text="Мои поездки")
                button_add_order = types.KeyboardButton(text="Новая поездка")
                buttons_actions.add(button_history_ways, button_add_order)
                mess = bot.send_message(message.chat.id, "Выберите действие.", reply_markup=buttons_actions)
                bot.register_next_step_handler(mess, choose_action_passenger, input_phone, message.chat.id)      
        
                return 0
    
    
        mycursor.execute('SELECT * FROM taxi_drivers')      # поиск номера телефона в таблице таксистов
        drivers = mycursor.fetchall()
        print(drivers)
        for user in drivers:
            table_phone = user[1]
            if table_phone == input_phone:   
                buttons_actions = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
                button_settings = types.KeyboardButton(text="Настройки")
                button_choose_order = types.KeyboardButton(text="Выбрать поездку")
                buttons_actions.add(button_settings, button_choose_order)
                mess = bot.send_message(message.chat.id, "Выберите действие.", reply_markup=buttons_actions)
                bot.register_next_step_handler(mess, choose_action_taxi_driver, input_phone, message.chat.id)      
        
                return 0
            
        # пустая
        buttons_characters = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
        button_taxi_driver = types.KeyboardButton(text="Таксист")
        button_passenger = types.KeyboardButton(text="Пассажир")
        buttons_characters.add(button_taxi_driver, button_passenger)
        mess = bot.send_message(message.chat.id, "Выберите кем вы являетесь?", reply_markup=buttons_characters)
        bot.register_next_step_handler(mess, choose_character, input_phone)      
    
    except:
        mess = bot.send_message(message.chat.id, "Пожалуйста, отправьте номер телефона")
        bot.register_next_step_handler(mess, regist_and_auth)
